> Currently tracking: API 1.0 (29/09/2020)

# API Overview

While testing your app, you may wish to create/join the game with another client, for this we've released
[API-Tool](https://github.com/UCLanTeamNaN/api-tool) - a Python script for interacting with the API.

## Standardisation

This API always returns a **200 OK** response when operating normally (i.e, the server isn't broken)

The API returns a CSV plain-text response, that can be viewed in a web browser. While the output
of the API isn't always standard, the first row of the CSV table is.

The first row of the table represents the request's result in the following schema:

`[result, verbose_status]`

If the request is successful, expect to see `"OK", "Okay"`

An example failure message could be: `"Invalid player name","You are not recognised: Please create or join a game."`

> NOTE: All endpoints use the GET HTTP method, even when sending data to the game server. Expect to send all data over query parameters within the URL.

> NOTE: The server does not support HTTPs, be aware of this while hand-typing the URLs into your applications.

> NOTE: Modern browsers (i.e Chrome) attempt to redirect to HTTPS://challenge, you must use an older browser (iexplore) or an API dev tool

> NOTE: Be careful not to disturb other teams while testing.


## Sending Data

Data is sent in the parameters of a GET request to the API.

### Authentication
Any endpoints that require authentication will need to send the JSESSION token, that's sent after the endpoint name & before the queries start in the URI.

Example: `http://4wc.example.com/test/getMaps;jsessionid={YOUR_SESSION}?extraData={}`

> NOTE: Some browsers (iexplore) and dev tools may store the jsessionid in their cookies, so you can probably leave this out of your requests made within those. api-tool stores the jsession token in a file named .sessiontoken

## Standard Parameters

### appID

Some endpoints require an appID, this is a name used to identify your app. It should be the same everytime you send it and must start with your team number.

For example

`8A - HideNSeek Dev`

> NOTE: It's important you get your appID correct as it's used to award points.

### playerName

The joinGame and createGame endpoints require a playerName, this should be a non-empty string that identifies the player in the game.

### sessionID

This is a unique value the client should use whenever performing an action. It identifies & authenticates the user on the server.

This doesn't need to be shared with the user & should be stored persistently, so the game can be restored if the game crashes/is exited by mistake.

### gameID

An incremental numeric ID number for the game session, generated by the server. This should be shown to the user
so they can share it as it allows others to join their game.

It can be used for getting information from games that your user isn't part of it (i.e, the player list.)

## Testing

We recommend the following tools for testing with the API:

- [Postman](https://www.postman.com/) - An API testing tool
- [Insomnia Core](https://insomnia.rest/) - A light-weight API testing tool
- [api-tool](https://github.com/UCLanTeamNaN/api-tool) - Our own 4WC testing tool

You can also type URLs into Internet Explorer to test, but it's recommended you use one of the above tools.

## Foot notes

## Failure messages

Some common failure messages include:

- Invalid Player - The jsessionid is probably invalid
- Missing Parameter - You've missed a parameter, check the docs again.
- Error - Something is wrong on the server-side
- Database Error - Server-side database issue.
- Invalid Parameter - A value sent was invalid, so no data could be returned
- Name unavailable - You're trying to use a username that's already in use.
- Not in play - You're trying to move in a game that's either not started/not finished
- Bad Move - You've requested a move that's not possible on the map with your current location.
- Cannot join game - You're trying to join a game that doesn't have an open lobby
- Cannot start game - You're trying to start a game with only 1 player.


We hope this documentation & api-tool are useful to other teams, Team NaN.